<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kannada OCR + Transliteration + Translation</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.3/dist/tesseract.min.js"></script>

<style>
body { font-family: sans-serif; padding: 15px; background:#111; color:white; }
h2 { margin-top:25px; }
textarea { width:100%; height:150px; font-size:18px; padding:10px; }
button {
  width:100%; padding:12px; margin-top:10px;
  font-size:18px; border-radius:10px;
  background:linear-gradient(45deg,#ff3399,#7f66ff);
  color:white; border:none;
}
.credit{margin-top:40px;text-align:center;font-family:cursive;opacity:0.75;}
</style>
</head>
<body>

<h2>Upload Image</h2>
<input type="file" id="fileInput" accept="image/*">
<div id="status"></div>

<h2>OCR Result (Kannada)</h2>
<textarea id="ocr"></textarea>
<button onclick="download('ocr')">Download OCR</button>

<h2>Transliteration</h2>
<textarea id="latin"></textarea>
<button onclick="download('latin')">Download Transliteration</button>

<h2>English Translation</h2>
<textarea id="eng"></textarea>
<button onclick="download('eng')">Download Translation</button>

<div class="credit">Created by Animesh</div>

<script>
document.getElementById("fileInput").addEventListener("change", async function () {
    const file = this.files[0];
    if (!file) return;

    document.getElementById("status").innerText = "Running OCR…";

    try {
        const result = await Tesseract.recognize(file, 'kan+eng');
        const text = result.data.text.trim();
        document.getElementById("ocr").value = text;
        document.getElementById("status").innerText = "OCR Done!";

        transliterate(text);
        translate(text);

    } catch (e) {
        document.getElementById("status").innerText = "OCR Failed";
        console.log(e);
    }
});

async function transliterate(text){
    document.getElementById("latin").value="Working…";
    try{
        const r=await fetch("https://api.libretranslate.com/transliterate",{
            method:"POST",
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({
                q:text,
                source:"kn",
                target:"en"
            })
        });
        const json=await r.json();
        document.getElementById("latin").value=json.transliteratedText || "Transliteration failed.";
    }catch(e){
        document.getElementById("latin").value="Transliteration failed.";
    }
}

async function translate(text){
    document.getElementById("eng").value="Working…";
    try{
        const r=await fetch("https://api.libretranslate.com/translate",{
            method:"POST",
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({
                q:text,
                source:"kn",
                target:"en"
            })
        });
        const json=await r.json();
        document.getElementById("eng").value=json.translatedText || "Translation failed.";
    }catch(e){
        document.getElementById("eng").value="Translation failed.";
    }
}

function download(id){
  const text=document.getElementById(id).value;
  const a=document.createElement("a");
  a.href='data:text/plain;charset=utf-8,'+encodeURIComponent(text);
  a.download=id+".txt";
  a.click();
}
</script>

</body>
</html>
